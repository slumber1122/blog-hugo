+++
date = "2017-05-13T19:09:19+08:00"
tags = ["",""]
slug = ""
title = "rsa"

+++
## RSA
* 随机选择两个不相等的质数p和q， 61和53
* 计算p和q的乘积n，n=3233，n的长度就是密钥长度，3233的二进制110010100001，12位。密钥长度12，一般是1024位。
* 计算n的欧拉函数φ(n)，`φ(n) = (p-1)(q-1)`，`φ(3233)=60*52=3120`
* 随机选择一个整数e，条件是1< e < φ(n)，且e与φ(n) 互质。例如17。实际使用65537
* 计算e对于φ(n)的模反元素d: 指有一个整数d，可以使得ed被φ(n)除的余数为1。
```
ed ≡ 1 (mod φ(n)) // 等价
ed - 1 = kφ(n) // 解得d，就是对下面的二元一次方程求解
ex + φ(n)y = 1 // 可以通过[扩展欧几里得算法](https://zh.wikipedia.org/wiki/%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95)
d=2753
```
* 将n和e封装成公钥，n和d封装成私钥。
```
n=3233，e=17，d=2753，所以公钥就是 (3233,17)，私钥就是（3233, 2753）
```

## 加密消息
* 加密用公钥,向一个人发加密信息，则需要用那个人的公钥加密消息。消息是m，转化成整数，字符串可以取ascii值，m必须小于n。
```
m^e ≡ c (mod n) // 假设m=65，c等于2790，所以加密消息位c
```
* 收到消息后，解密用私钥
```
　c^d ≡ m (mod n) // 得到m
```

## 签名
自己发送的消息，别人都可以验证，可以自证身份
对一段信息进行签名时，一般会先用哈希函数计算出被签名信息惟一的哈希结果值。最后使用私钥将哈希结果值转化为数字签名。得到的数字签名对于被签名的信息和用以创建数字签名的私钥而言都是独一无二的。

在验证数字签名的时候，一般会将签名数据、原始数据、公钥一起作为参数输入，返回验证true或false。
